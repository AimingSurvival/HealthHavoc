<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Guide to a Balanced Indian Diet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Neutrals -->
    <!-- Application Structure Plan: The SPA is structured into five logical sections for optimal user experience: an introduction, an interactive macronutrient explorer, a tabbed micronutrient guide, a data visualizer, and a new Smart Diet Tools section. This thematic dashboard approach was chosen over a simple table to make the dense nutritional information more digestible and engaging. Users can get a high-level overview and then "drill down" into specific nutrients they are interested in. The data visualizer section provides a powerful, interactive way to compare nutrient recommendations, making the data more tangible. The new Smart Diet Tools leverage AI for practical, personalized dietary assistance. This user-driven, progressive disclosure model is designed for better comprehension, retention, and direct utility. -->
    <!-- Visualization & Content Choices: 
        1. Macronutrients: Report Info -> Macro details. Goal -> Inform & Compare. Viz -> Interactive HTML cards. Interaction -> Click to expand. Justification -> More engaging than a static table, allows focused learning. Library -> HTML/CSS.
        2. Micronutrients: Report Info -> Vitamin & Mineral details. Goal -> Organize & Inform. Viz -> Tabbed grid of cards. Interaction -> Click to reveal details. Justification -> Cleanly separates dense data, prevents overwhelm. Library -> HTML/CSS.
        3. Diet Composition: Report Info -> Macro calorie percentages. Goal -> Visualize Proportions. Viz -> Donut Chart. Interaction -> Static display for immediate insight. Justification -> Best for showing part-to-whole data. Library -> Chart.js.
        4. Nutrient Comparison: Report Info -> Specific nutrient RDA. Goal -> Explore & Quantify. Viz -> Bar Chart & Dynamic Text. Interaction -> User selects nutrient via buttons to update chart and text. Justification -> Makes abstract numbers concrete and interactive. Library -> Chart.js.
        5. Recipe Generator: Report Info -> User ingredients. Goal -> Provide practical utility. Viz -> Text output. Interaction -> User input + button click. Justification -> Direct application of LLM for user benefit. Library -> Gemini API.
        6. Meal Plan Suggestion: Report Info -> User dietary preferences. Goal -> Provide personalized guidance. Viz -> Text output. Interaction -> User selection + button click. Justification -> Direct application of LLM for user benefit. Library -> Gemini API.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF6;
            color: #333333;
        }
        .nutrient-card {
            transition: all 0.3s ease-in-out;
            cursor: pointer;
        }
        .nutrient-card .details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .nutrient-card.open .details {
            max-height: 500px; /* Adjust as needed for content */
            transition: max-height 0.5s ease-in;
        }
        .tab-button.active {
            background-color: #81B29A;
            color: white;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px; /* Max width for chart container */
            margin-left: auto;
            margin-right: auto;
            height: 300px; /* Base height for charts */
            max-height: 400px; /* Max height for charts */
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .ai-button {
            background-color: #E07A5F;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }
        .ai-button:hover {
            background-color: #BF4F36;
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #E07A5F;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-md sticky top-0 z-10">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl md:text-2xl font-bold text-[#3D405B]">Your Guide to a Balanced Diet</h1>
            <div class="hidden md:flex space-x-6">
                <a href="#macronutrients" class="text-gray-600 hover:text-[#E07A5F] transition">Macronutrients</a>
                <a href="#micronutrients" class="text-gray-600 hover:text-[#E07A5F] transition">Micronutrients</a>
                <a href="#visualizer" class="text-gray-600 hover:text-[#E07A5F] transition">Visualizer</a>
                <a href="#smart-tools" class="text-gray-600 hover:text-[#E07A5F] transition">Smart Tools ✨</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12">

        <section id="intro" class="text-center mb-16">
            <h2 class="text-3xl md:text-4xl font-bold mb-4 text-[#3D405B]">Nourish Your Body, Fuel Your Life</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-700">
                Welcome to your interactive guide to nutrition. This application translates general dietary recommendations for adult Indian men into an easy-to-understand format. Explore the essential nutrients your body needs to thrive, discover rich food sources, and visualize how to build a balanced plate.
            </p>
        </section>

        <section id="macronutrients" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#3D405B]">The Building Blocks: Macronutrients</h2>
            <p class="text-center text-gray-600 mb-8">Click on each card to explore the three key macronutrients that provide your body with energy.</p>
            <div id="macro-cards-container" class="grid md:grid-cols-3 gap-8">
            </div>
        </section>

        <section id="micronutrients" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#3D405B]">Vital Spark Plugs: Micronutrients</h2>
            <p class="text-center text-gray-600 mb-8">Discover the vitamins and minerals crucial for your body's functions. Click on a nutrient to learn more.</p>
            <div class="flex justify-center mb-8">
                <div class="bg-gray-200 rounded-full p-1 flex space-x-1">
                    <button id="vitamins-tab" class="tab-button px-6 py-2 rounded-full font-semibold transition active">Vitamins</button>
                    <button id="minerals-tab" class="tab-button px-6 py-2 rounded-full font-semibold transition">Minerals</button>
                </div>
            </div>
            <div id="micro-cards-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6">
            </div>
        </section>

        <section id="visualizer" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#3D405B]">Interactive Diet Visualizer</h2>
            <p class="text-center text-gray-600 mb-8">See how these nutrients come together in a balanced diet.</p>
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div class="w-full">
                    <h3 class="text-xl font-semibold text-center mb-4">Ideal Macronutrient Split</h3>
                    <div class="chart-container">
                        <canvas id="macroChart"></canvas>
                    </div>
                </div>
                <div class="w-full">
                    <h3 class="text-xl font-semibold text-center mb-4">Micronutrient Daily Goals</h3>
                    <div id="micro-selector" class="flex flex-wrap justify-center gap-2 mb-4">
                    </div>
                    <div id="micro-display" class="bg-white p-6 rounded-lg shadow-lg min-h-[180px] flex flex-col justify-center">
                        <p class="text-center text-gray-500">Select a micronutrient to see its details.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="smart-tools" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#3D405B]">Smart Diet Tools ✨</h2>
            <p class="text-center text-gray-600 mb-8">Leverage AI to get personalized recipe and meal plan suggestions.</p>

            <div class="grid md:grid-cols-2 gap-12">
                <!-- Recipe Generator -->
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-[#3D405B]">Recipe Generator ✨</h3>
                    <p class="text-gray-600 mb-4">Enter a list of ingredients you have, and I'll suggest a simple, balanced recipe for you.</p>
                    <textarea id="ingredients-input" class="w-full p-3 border border-gray-300 rounded-md mb-4 resize-y min-h-[100px]" placeholder="e.g., Paneer, spinach, tomatoes, ginger, garlic"></textarea>
                    <button id="generate-recipe-btn" class="ai-button w-full">Generate Recipe ✨</button>
                    <div id="recipe-output" class="mt-6 p-4 bg-gray-50 rounded-md border border-gray-200 min-h-[150px] text-gray-700 overflow-auto">
                        <p class="text-gray-500">Your recipe will appear here...</p>
                    </div>
                </div>

                <!-- Meal Plan Suggestion -->
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-[#3D405B]">Meal Plan Suggestion ✨</h3>
                    <p class="text-gray-600 mb-4">Select your dietary preferences, and I'll suggest a one-day balanced meal plan.</p>
                    <div class="mb-4">
                        <label class="inline-flex items-center mr-4">
                            <input type="checkbox" id="pref-vegetarian" value="Vegetarian" class="form-checkbox h-5 w-5 text-[#E07A5F] rounded">
                            <span class="ml-2 text-gray-700">Vegetarian</span>
                        </label>
                        <label class="inline-flex items-center mr-4">
                            <input type="checkbox" id="pref-highprotein" value="High Protein" class="form-checkbox h-5 w-5 text-[#E07A5F] rounded">
                            <span class="ml-2 text-gray-700">High Protein</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="checkbox" id="pref-quickmeals" value="Quick Meals" class="form-checkbox h-5 w-5 text-[#E07A5F] rounded">
                            <span class="ml-2 text-gray-700">Quick Meals</span>
                        </label>
                    </div>
                    <button id="suggest-mealplan-btn" class="ai-button w-full">Suggest Meal Plan ✨</button>
                    <div id="mealplan-output" class="mt-6 p-4 bg-gray-50 rounded-md border border-gray-200 min-h-[150px] text-gray-700 overflow-auto">
                        <p class="text-gray-500">Your meal plan will appear here...</p>
                    </div>
                </div>
            </div>
        </section>

    </main>
    
    <footer class="bg-gray-800 text-white mt-16 py-6">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 Nutritional Guide. All Rights Reserved.</p>
            <p class="text-sm text-gray-400 mt-2">The information provided is for general guidance only and does not substitute for professional medical advice. Consult a healthcare provider or registered dietitian for personalized recommendations.</p>
        </div>
    </footer>

    <script>
        const dietData = {
            macronutrients: [
                { name: 'Carbohydrates', dailyRec: '250-350 g', percentage: '50-60%', function: 'Main energy source, provide fiber, support brain function', types: [{ name: 'Complex', sources: 'Whole wheat (roti, bread, atta), brown rice, oats, millets (bajra, ragi, jowar), quinoa, legumes (dal, chickpeas), potatoes, sweet potatoes' }, { name: 'Simple', sources: 'Limit intake from added sugars: Sugar, jaggery, honey, fruits' }] },
                { name: 'Proteins', dailyRec: '60 g', percentage: '15-20%', function: 'Build and repair tissues, muscle growth, enzyme and hormone production, immune function', types: [{ name: 'Complete', sources: 'Chicken, fish, eggs, dairy (milk, paneer, yogurt), soy, quinoa' }, { name: 'Incomplete', sources: 'Legumes (dal, beans), nuts, seeds, grains (combine to make complete)' }] },
                { name: 'Fats', dailyRec: '<70g', percentage: '20-30%', function: 'Energy storage, hormone production, insulation, vitamin absorption', types: [{ name: 'Saturated', sources: '<10% of calories: Ghee, butter, red meat, coconut oil' }, { name: 'Monounsaturated', sources: 'Olive oil, groundnut oil, avocado, almonds, cashews' }, { name: 'Polyunsaturated', sources: 'Omega-3: Fatty fish, flaxseeds, walnuts; Omega-6: Sunflower oil, soybean oil' }] }
            ],
            micronutrients: {
                vitamins: [
                    { name: 'Vitamin A', rec: '600 mcg', sources: 'Carrots, spinach, mango, sweet potatoes', func: 'Vision, immune function, skin health' },
                    { name: 'Vitamin C', rec: '40 mg', sources: 'Amla, guava, citrus fruits, bell peppers', func: 'Immune support, antioxidant' },
                    { name: 'Vitamin D', rec: '10 mcg', sources: 'Sunlight, fatty fish, fortified milk', func: 'Bone health, calcium absorption' },
                    { name: 'Vitamin E', rec: '10 mg', sources: 'Almonds, sunflower seeds, spinach', func: 'Antioxidant, protects cells' },
                    { name: 'B Vitamins', rec: 'Varies', sources: 'Whole grains, legumes, leafy greens, eggs, meat', func: 'Energy metabolism, nerve function' }
                ],
                minerals: [
                    { name: 'Calcium', rec: '600 mg', sources: 'Milk, paneer, yogurt, ragi, leafy greens', func: 'Bone and teeth strength, muscle function' },
                    { name: 'Iron', rec: '8 mg', sources: 'Lentils, spinach, jaggery, red meat', func: 'Oxygen transport, energy production' },
                    { name: 'Zinc', rec: '12 mg', sources: 'Legumes, nuts, seeds, meat, dairy', func: 'Immune function, wound healing' },
                    { name: 'Potassium', rec: '3500 mg', sources: 'Bananas, potatoes, spinach, lentils', func: 'Fluid balance, nerve signals' },
                    { name: 'Sodium', rec: '<2000 mg', sources: 'Table salt, processed foods (limit)', func: 'Fluid balance (excess raises BP)' },
                    { name: 'Iodine', rec: '150 mcg', sources: 'Iodized salt, seafood, dairy', func: 'Thyroid hormone production' }
                ]
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            const macroContainer = document.getElementById('macro-cards-container');
            const microContainer = document.getElementById('micro-cards-container');
            const vitaminsTab = document.getElementById('vitamins-tab');
            const mineralsTab = document.getElementById('minerals-tab');
            const microSelector = document.getElementById('micro-selector');
            const microDisplay = document.getElementById('micro-display');
            
            const ingredientsInput = document.getElementById('ingredients-input');
            const generateRecipeBtn = document.getElementById('generate-recipe-btn');
            const recipeOutput = document.getElementById('recipe-output');

            const prefVegetarian = document.getElementById('pref-vegetarian');
            const prefHighProtein = document.getElementById('pref-highprotein');
            const prefQuickMeals = document.getElementById('pref-quickmeals');
            const suggestMealplanBtn = document.getElementById('suggest-mealplan-btn');
            const mealplanOutput = document.getElementById('mealplan-output');

            const macroColors = {
                'Carbohydrates': '#F9C74F',
                'Proteins': '#F94144',
                'Fats': '#43AA8B'
            };

            function createMacroCards() {
                dietData.macronutrients.forEach(macro => {
                    const card = document.createElement('div');
                    card.className = 'nutrient-card bg-white rounded-lg shadow-lg p-6 hover:shadow-xl hover:-translate-y-1';
                    card.innerHTML = `
                        <div class="flex justify-between items-start">
                             <h3 class="text-2xl font-bold mb-2" style="color: ${macroColors[macro.name]}">${macro.name}</h3>
                             <div class="text-right">
                                 <p class="font-bold text-lg">${macro.percentage}</p>
                                 <p class="text-sm text-gray-500">of daily calories</p>
                             </div>
                        </div>
                        <p class="text-gray-600 mb-4">${macro.function}</p>
                        <div class="details">
                            ${macro.types.map(type => `
                                <div class="mt-4">
                                    <h4 class="font-semibold text-md">${type.name}</h4>
                                    <p class="text-sm text-gray-500">${type.sources}</p>
                                </div>
                            `).join('')}
                        </div>
                         <div class="text-center mt-4">
                            <span class="text-sm font-semibold text-[#3D405B]">Click to see sources</span>
                        </div>
                    `;
                    card.addEventListener('click', () => {
                        card.classList.toggle('open');
                    });
                    macroContainer.appendChild(card);
                });
            }

            function createMicroCards(type) {
                microContainer.innerHTML = '';
                dietData.micronutrients[type].forEach(micro => {
                    const card = document.createElement('div');
                    card.className = 'nutrient-card bg-white rounded-lg shadow p-3 text-center hover:shadow-lg';
                    card.innerHTML = `
                        <h4 class="font-bold text-md">${micro.name}</h4>
                        <p class="text-sm text-gray-500 mb-2">${micro.rec}</p>
                        <div class="details">
                             <p class="text-xs text-gray-600 font-semibold">${micro.func}</p>
                             <p class="text-xs text-gray-500 mt-1"><strong>Sources:</strong> ${micro.sources}</p>
                        </div>
                    `;
                     card.addEventListener('click', () => {
                        card.classList.toggle('open');
                    });
                    microContainer.appendChild(card);
                });
            }
            
            function populateMicroSelector() {
                 [...dietData.micronutrients.vitamins, ...dietData.micronutrients.minerals].forEach(micro => {
                    const button = document.createElement('button');
                    button.className = 'bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm font-semibold hover:bg-[#81B29A] hover:text-white transition';
                    button.textContent = micro.name;
                    button.onclick = () => updateMicroDisplay(micro);
                    microSelector.appendChild(button);
                 });
            }

            function updateMicroDisplay(micro) {
                microDisplay.innerHTML = `
                    <h4 class="text-lg font-bold text-center text-[#3D405B]">${micro.name}</h4>
                    <p class="text-center text-3xl font-bold my-2">${micro.rec}</p>
                    <p class="text-center text-sm text-gray-600">Recommended Daily Intake</p>
                    <p class="text-center text-sm text-gray-500 mt-2"><strong>Function:</strong> ${micro.func}</p>
                `;
            }

            vitaminsTab.addEventListener('click', () => {
                createMicroCards('vitamins');
                vitaminsTab.classList.add('active');
                mineralsTab.classList.remove('active');
            });

            mineralsTab.addEventListener('click', () => {
                createMicroCards('minerals');
                mineralsTab.classList.add('active');
                vitaminsTab.classList.remove('active');
            });
            
            function createMacroChart() {
                const ctx = document.getElementById('macroChart').getContext('2d');
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Carbohydrates', 'Proteins', 'Fats'],
                        datasets: [{
                            label: '% of Daily Calories',
                            data: [55, 20, 25],
                            backgroundColor: [
                                macroColors['Carbohydrates'],
                                macroColors['Proteins'],
                                macroColors['Fats']
                            ],
                            borderColor: '#FDFBF6',
                            borderWidth: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    font: {
                                        size: 14,
                                        family: 'Inter'
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed !== null) {
                                            label += context.parsed + '%';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Gemini API Integration
            async function callGeminiAPI(prompt, outputDiv, loadingButton) {
                outputDiv.innerHTML = `<p class="text-center text-gray-500"><span class="loading-spinner"></span> Generating...</p>`;
                loadingButton.disabled = true;

                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    // API key is not needed here; Canvas provides it automatically at runtime.
                    const apiKey = ""; 
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent`; // Removed ?key=${apiKey}

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        outputDiv.innerHTML = `<p>${text.replace(/\n/g, '<br>')}</p>`;
                    } else {
                        outputDiv.innerHTML = `<p class="text-red-500">Error: Could not generate response. Please try again.</p>`;
                    }
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    outputDiv.innerHTML = `<p class="text-red-500">Error: Failed to connect to AI. Please try again later.</p>`;
                } finally {
                    loadingButton.disabled = false;
                }
            }

            generateRecipeBtn.addEventListener('click', () => {
                const ingredients = ingredientsInput.value.trim();
                if (ingredients) {
                    const prompt = `Suggest a simple, balanced Indian recipe using these ingredients: ${ingredients}. Provide a list of ingredients and step-by-step instructions.`;
                    callGeminiAPI(prompt, recipeOutput, generateRecipeBtn);
                } else {
                    recipeOutput.innerHTML = `<p class="text-red-500">Please enter some ingredients!</p>`;
                }
            });

            suggestMealplanBtn.addEventListener('click', () => {
                const preferences = [];
                if (prefVegetarian.checked) preferences.push(prefVegetarian.value);
                if (prefHighProtein.checked) preferences.push(prefHighProtein.value);
                if (prefQuickMeals.checked) preferences.push(prefQuickMeals.value);

                let prompt = `Suggest a one-day balanced Indian meal plan (Breakfast, Lunch, Dinner, Snacks).`;
                if (preferences.length > 0) {
                    prompt += ` Consider the following preferences: ${preferences.join(', ')}.`;
                } else {
                    prompt += ` Assume a general healthy diet for an adult Indian man.`;
                }

                callGeminiAPI(prompt, mealplanOutput, suggestMealplanBtn);
            });


            createMacroCards();
            createMicroCards('vitamins');
            createMacroChart();
            populateMicroSelector();
            
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });

        });
    </script>
</body>
</html>
